var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},acrolinxLibs;!function(a){"use strict";var b=window,c=b.acrolinxLibs||{};a.Q=c.Q||b.Q,a._=c._||b._}(acrolinxLibs||(acrolinxLibs={}));var acrolinx;!function(a){var b;!function(a){"use strict";a.SoftwareComponentCategory={MAIN:"MAIN",DEFAULT:"DEFAULT",DETAIL:"DETAIL"},a.ErrorCodes={checkIsAlreadyRunning:"checkIsAlreadyRunning",userIsNotLoggedIn:"userIsNotLoggedIn",sidebarNotReadyForCheck:"sidebarNotReadyForCheck",checkCanceledByUser:"checkCanceledByUser",base64EncodedGzippedUnsupported:"base64EncodedGzippedUnsupported"}}(b=a.sidebar||(a.sidebar={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];d&&console.log.apply(console,[a].concat(b))}function c(){d=!0}var d=!1;a.log=b,a.enableLogging=c}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){"use strict";function c(a){var b=[],c=0,d=0;return a.forEach(function(a){var e=a[0],f=a[1];switch(e){case DIFF_EQUAL:c+=f.length;break;case DIFF_DELETE:c+=f.length,d-=f.length;break;case DIFF_INSERT:d+=f.length;break;default:throw new Error("Illegal Diff Action: "+e)}b.push({oldPosition:c,diffOffset:d})}),b}function d(a){var b=document.createElement("div");return b.innerHTML=a,b.textContent}function e(a){var b=/(<([^>]+)>|&.*?;)/gi,c=[],e=0,f=a.replace(b,function(a,b,f,g){var h=j.startsWith(a,"&")?d(a):"";return e-=a.length-h.length,c.push({oldPosition:g+a.length,diffOffset:e}),h});return[f,c]}function f(a,b){if(0===a.length)return 0;var c=j.sortedIndexBy(a,{diffOffset:0,oldPosition:b+.1},function(a){return a.oldPosition});return c>0?a[c-1].diffOffset:0}function g(a,b){return!1}function h(a,b){return a.slice(b.range[0],b.range[1])}function i(a,b,d,i){if(void 0===i&&(i="HTML"),j.isEmpty(d))return[];var m="HTML"===i?e(a):[a,[]],n=m[0],o=m[1],p=l.diff_main(n,b),q=c(p),r=d.map(function(a){var b=a.range[0]+f(o,a.range[0]),c=a.range[1]+f(o,a.range[1]),d=b+f(q,b),e=c-1,h=e+f(q,e)+1,i=g(q,a.range[0])||g(q,a.range[1]);return{originalMatch:a,range:[d,h],hasModifiedWordBorders:i}}),s=j.some(r,function(a){return h(b,a)!==a.originalMatch.content||a.hasModifiedWordBorders});return k("checkedDocument",a),k("cleanedCheckedDocument",n),k("cleanedCheckedDocumentCodes",n.split("").map(function(a){return a.charCodeAt(0)})),k("currentDocument",b),k("currentDocumentCodes",b.split("").map(function(a){return a.charCodeAt(0)})),k("matches",d),k("diffs",p),k("alignedMatches",r),k("alignedMatchesContent",r.map(function(a){return h(b,a)})),s?[]:r}var j=acrolinxLibs._,k=a.plugins.utils.log,l=new diff_match_patch;b.createOffsetMappingArray=c,b.replaceTags=e,b.findNewOffset=f,b.lookupMatches=i}(c=b.diffbased||(b.diffbased={}))}(c=b.lookup||(b.lookup={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a,b){var c=Date.now(),d=b();return console.log('Duration of "'+a+':"',Date.now()-c),d}function c(a){return a[a.length-1].range[1]-a[0].range[0]}function d(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onload=function(){if(!(c.status>=200&&c.status<400))throw new Error("Error while loading "+a+".");b(c.responseText)},c.onerror=function(){throw new Error("Error while loading "+a+".")},c.send()}function e(a){return"IFRAME"===a.nodeName}a.logTime=b,a.getCompleteFlagLength=c,a.fetch=d,a.isIFrame=e}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(c){"use strict";var d=a.plugins.lookup.diffbased.lookupMatches,e=acrolinxLibs._,f=a.plugins.utils.getCompleteFlagLength,g=function(){function a(){}return a.prototype.getEditorElement=function(){return this.getEditorDocument().querySelector("body")},a.prototype.registerCheckCall=function(a){},a.prototype.registerCheckResult=function(a){this.isCheckingNow=!1,this.currentHtmlChecking=this.html,this.prevCheckedHtml=this.currentHtmlChecking},a.prototype.extractHTMLForCheck=function(){return this.html=this.getHTML(),this.currentHtmlChecking=this.html,{html:this.html}},a.prototype.scrollIntoView=function(a){var b=a.getRangeAt(0),c=b.cloneRange();c.collapse(!1);var d=document.createElement("span");c.insertNode(d),d.scrollIntoView(),d.remove()},a.prototype.scrollToCurrentSelection=function(){var a=this.getEditorDocument().getSelection();if(a)try{this.scrollIntoView(a)}catch(b){console.log("Scrolling Error: ",b)}},a.prototype.selectRanges=function(a,b){this.selectMatches(a,b),this.scrollToCurrentSelection()},a.prototype.selectMatches=function(a,b){var c=this.getTextDomMapping(),f=d(this.currentHtmlChecking,c.text,b);if(e.isEmpty(f))throw new Error("Selected flagged content is modified.");return this.selectAlignedMatches(f,c),[f,c]},a.prototype.selectAlignedMatches=function(a,b){var c=a[0].range[0],d=f(a);this.selectText(c,d,b)},a.prototype.selectText=function(a,b,c){if(c.text){var d=this.getEditorDocument(),e=d.getSelection();e.removeAllRanges(),e.addRange(this.createRange(a,b,c))}},a.prototype.createRange=function(a,c,d){var e=this.getEditorDocument(),f=e.createRange(),g=d.domPositions[a],h=b.utils.getEndDomPos(a+c,d.domPositions);return f.setStart(g.node,g.offset),f.setEnd(h.node,h.offset),f},a.prototype.replaceAlignedMatches=function(a){for(var b=this.getEditorDocument(),c=e.clone(a).reverse(),d=0,f=c;d<f.length;d++){var g=f[d],h=this.getTextDomMapping(),i=g.range[1]-g.range[0];if(i>1){var j=this.createRange(g.range[0]+1,i-1,h),k=this.createRange(g.range[0],1,h);j.deleteContents(),k.deleteContents(),k.insertNode(b.createTextNode(g.originalMatch.replacement))}else{var l=this.createRange(g.range[0],i,h);l.deleteContents(),l.insertNode(b.createTextNode(g.originalMatch.replacement))}}},a.prototype.replaceRanges=function(a,b){var c=this.selectMatches(a,b)[0],d=c.map(function(a){return a.originalMatch.replacement}).join("");this.replaceAlignedMatches(c),this.selectText(c[0].range[0],d.length,this.getTextDomMapping()),this.scrollToCurrentSelection()},a.prototype.getTextDomMapping=function(){return b.utils.extractTextDomMapping(this.getEditorElement())},a}();c.AbstractRichtextEditorAdapter=g}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a){return!!a.editorId}function c(a){return b(a)?document.getElementById(a.editorId):a.element}a.isHasEditorID=b,a.getElementFromAdapterConf=c}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";var c=function(){function b(a){this.conf=a}return b.prototype.extractHTMLForCheck=function(){var b=this;return this.multiAdapter=new a.plugins.adapter.MultiEditorAdapter(this.conf),a.plugins.autobind.bindAdaptersForCurrentPage().forEach(function(a){b.multiAdapter.addSingleAdapter(a)}),this.multiAdapter.extractHTMLForCheck()},b.prototype.registerCheckCall=function(a){},b.prototype.registerCheckResult=function(a){},b.prototype.selectRanges=function(a,b){this.multiAdapter.selectRanges(a,b)},b.prototype.replaceRanges=function(a,b){this.multiAdapter.replaceRanges(a,b)},b}();b.AutoBindAdapter=c}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(a){function b(b){a.call(this),this.editorId=b.editorId}return __extends(b,a),b.prototype.getEditor=function(){return CKEDITOR.instances[this.editorId]},b.prototype.getEditorDocument=function(){return this.getEditor().document.$},b.prototype.getHTML=function(){return this.getEditor().getData()},b.prototype.extractHTMLForCheck=function(){if(this.html=this.getHTML(),this.currentHtmlChecking=this.html,this.isInWysiwygMode())""===this.html&&(this.html="<span> </span>");else{if(!this.isCheckingNow)return{error:"Action is not permitted in Source mode."};this.isCheckingNow=!1}return{html:this.html}},b.prototype.selectRanges=function(b,c){this.isInWysiwygMode()?a.prototype.selectRanges.call(this,b,c):window.alert("Action is not permitted in Source mode.")},b.prototype.replaceRanges=function(b,c){this.isInWysiwygMode()?a.prototype.replaceRanges.call(this,b,c):window.alert("Action is not permitted in Source mode.")},b.prototype.isInWysiwygMode=function(){return"wysiwyg"===this.getEditor().mode},b}(a.AbstractRichtextEditorAdapter);a.CKEditorAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(b){function c(c){b.call(this),this.element=a.getElementFromAdapterConf(c)}return __extends(c,b),c.prototype.getEditorElement=function(){return this.element},c.prototype.getHTML=function(){return this.element.innerHTML},c.prototype.getEditorDocument=function(){return this.element.ownerDocument},c}(a.AbstractRichtextEditorAdapter);a.ContentEditableAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";var c=a.plugins.lookup.diffbased.lookupMatches,d=acrolinxLibs._,e=a.plugins.utils.getCompleteFlagLength,f=function(){function a(a){this.element=b.getElementFromAdapterConf(a)}return a.prototype.getHTML=function(){return this.element.value},a.prototype.getCurrentText=function(){return this.getHTML()},a.prototype.getFormat=function(){return"TEXT"},a.prototype.extractHTMLForCheck=function(){return this.html=this.getHTML(),this.currentHtmlChecking=this.html,{html:this.html}},a.prototype.registerCheckResult=function(a){},a.prototype.registerCheckCall=function(a){},a.prototype.scrollAndSelect=function(a){var b=a[0].range[0],c=e(a),d=this.element;if(d.clientHeight<d.scrollHeight){var f=this.element.value;d.value=f.slice(0,b),d.focus(),d.scrollTop=1e9;var g=d.scrollTop;d.value=f,g>0&&(d.scrollTop=g+d.clientHeight/2)}d.setSelectionRange(b,b+c),d.focus(),d.scrollIntoView()},a.prototype.selectRanges=function(a,b){this.selectMatches(a,b)},a.prototype.selectMatches=function(a,b){var e=c(this.currentHtmlChecking,this.getCurrentText(),b,"TEXT");if(d.isEmpty(e))throw"Selected flagged content is modified.";return this.scrollAndSelect(e),e},a.prototype.replaceAlignedMatches=function(a){for(var b=d.clone(a).reverse(),c=this.element,e=c.value,f=0,g=b;f<g.length;f++){var h=g[f];e=e.slice(0,h.range[0])+h.originalMatch.replacement+e.slice(h.range[1])}c.value=e},a.prototype.replaceRanges=function(a,b){var c=this.selectMatches(a,b);this.scrollAndSelect(c),this.replaceAlignedMatches(c);var d=c[0].range[0],e=c.map(function(a){return a.originalMatch.replacement}).join("");this.element.setSelectionRange(d,d+e.length)},a}();b.InputAdapter=f}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=acrolinxLibs._,c=function(){function a(a){this.config=a,this.adapters=[]}return a.prototype.addSingleAdapter=function(a,b,c){void 0===b&&(b="div"),void 0===c&&(c="acrolinx_integration"+this.adapters.length),this.adapters.push({id:c,adapter:a,wrapper:b})},a.prototype.getWrapperTag=function(a){return a.split(" ")[0]},a.prototype.extractHTMLForCheck=function(){var a=this,b=acrolinxLibs.Q,c=b.defer(),d=this.adapters.map(function(a){return a.adapter.extractHTMLForCheck()});return b.all(d).then(function(b){for(var d="",e=0;e<a.adapters.length;e++){var f=a.adapters[e],g=a.getWrapperTag(f.wrapper),h="<"+f.wrapper+' id="'+f.id+'">',i=b[e].html,j=h+i+"</"+g+">";f.start=d.length+h.length,f.end=d.length+h.length+i.length,d+=j}c.resolve({html:d})}),c.promise},a.prototype.registerCheckCall=function(a){},a.prototype.registerCheckResult=function(a){this.checkResult=a,this.adapters.forEach(function(b){b.adapter.registerCheckResult(a)})},a.prototype.selectRanges=function(a,b){var c=this.remapMatches(b);for(var d in c)c[d].adapter.selectRanges(a,c[d].matches)},a.prototype.remapMatches=function(a){for(var c={},d=0,e=a;d<e.length;d++){var f=e[d],g=this.getAdapterForMatch(f);c.hasOwnProperty(g.id)||(c[g.id]={matches:[],adapter:g.adapter});var h=b.clone(f);h.range=[f.range[0]-g.start,f.range[1]-g.start],c[g.id].matches.push(h)}return c},a.prototype.getAdapterForMatch=function(a){return b.find(this.adapters,function(b){return a.range[0]>=b.start&&a.range[1]<=b.end})},a.prototype.replaceRanges=function(a,b){var c=this.remapMatches(b);for(var d in c)c[d].adapter.replaceRanges(a,c[d].matches)},a}();a.MultiEditorAdapter=c}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(a){function b(b){a.call(this),this.editorId=b.editorId}return __extends(b,a),b.prototype.getEditor=function(){return tinymce.get(this.editorId)},b.prototype.getHTML=function(){return this.getEditor().getContent()},b.prototype.getEditorDocument=function(){return this.getEditor().getDoc()},b.prototype.scrollToCurrentSelection=function(){var a=this.getEditorDocument().getSelection();if(a)try{var b=a.getRangeAt(0),c=b.startContainer,d=b.startOffset,e=b.endContainer,f=b.endOffset;a.collapseToStart(),this.getEditor().insertContent("");var g=this.getEditorDocument().createRange();g.setStart(c,d),g.setEnd(e,f),a.removeAllRanges(),a.addRange(g)}catch(h){console.log("Scrolling Error: ",h)}},b}(a.AbstractRichtextEditorAdapter);a.TinyMCEAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.getEditor=function(){return tinymce.get(this.editorId)},b.prototype.getHTML=function(){return this.getEditor().getContent()},b.prototype.getEditorDocument=function(){return this.getEditor().getDoc()},b.prototype.scrollToCurrentSelection=function(){var b=this.getEditor().getBody(),c=this.getEditor().getContainer().clientWidth,d=b.scrollWidth,e=c>d;e?a.prototype.scrollToCurrentSelection.call(this):this.scrollToCurrentSelectionWithGlobalScrollbar()},b.prototype.scrollToCurrentSelectionWithGlobalScrollbar=function(){var a=this.getEditorDocument().getSelection();if(a)try{this.scrollIntoViewWithGlobalScrollbar(a)}catch(b){console.log("Scrolling Error: ",b)}},b.prototype.scrollIntoViewWithGlobalScrollbar=function(a){var b=a.getRangeAt(0),c=b.cloneRange();c.collapse(!1);var d=document.createElement("span");c.insertNode(d);var e=d.getClientRects()[0].top;window.scrollTo(0,e),d.remove()},b}(a.TinyMCEAdapter);a.TinyMCEWordpressAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";function c(a){return a.offsetHeight>0&&a.offsetWidth>0}function d(a){void 0===a&&(a=document);var b=_.filter(a.querySelectorAll(i),c);return _.flatMap(b,function(a){if(!f(a))return[a];try{return a.contentDocument?d(a.contentDocument):[]}catch(b){return[]}})}function e(){return d().map(function(a){return"INPUT"===a.nodeName||"TEXTAREA"===a.nodeName?new g({element:a}):new h({element:a})})}var f=a.plugins.utils.isIFrame,g=a.plugins.adapter.InputAdapter,h=a.plugins.adapter.ContentEditableAdapter,i=["input:not([type])",'input[type=""]',"input[type=text]",'[contenteditable="true"]',"textarea","iframe"].join(", ");b.bindAdaptersForCurrentPage=e}(c=b.autobind||(b.autobind={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";function b(){var b=document.createElement("style"),c=document.querySelector("head");b.innerHTML="\n      #acrolinxFloatingSidebar {\n        top: "+d.top+"px;\n        left: "+d.left+"px;\n        position: fixed;\n        width: 300px;\n        padding-top: 20px;\n        cursor: move;\n        background: #3e96db;\n        height: 500px;\n        box-shadow: 5px 5px 30px rgba(0, 0, 0, 0.3);\n        border-radius: 3px;\n        user-select: none;\n        z-index: 10000;\n      }\n  \n      #acrolinxFloatingSidebar #"+a.SIDEBAR_CONTAINER_ID+",\n      #acrolinxFloatingSidebar #"+a.SIDEBAR_CONTAINER_ID+" iframe {\n        background: white;\n        height: 100%;\n        border: none;\n      }\n    ",c.appendChild(b)}function c(){function c(a,b){e.style.left=a+"px",e.style.top=b+"px"}var e=document.createElement("div");e.id="acrolinxFloatingSidebar";var f=document.querySelector("body"),g=!1,h=0,i=0;document.addEventListener("mousemove",function(a){g&&c(Math.max(a.clientX-h,0),Math.max(a.clientY-i,0))}),e.addEventListener("mousedown",function(a){var b=parseInt(e.style.left.replace("px",""))||d.left,c=parseInt(e.style.top.replace("px",""))||d.top;h=a.clientX-b,i=a.clientY-c,g=!0}),document.addEventListener("mouseup",function(){g=!1}),e.innerHTML='<div id="'+a.SIDEBAR_CONTAINER_ID+'"></div>',b(),f.appendChild(e)}a.SIDEBAR_CONTAINER_ID="acrolinxSidebarContainer";var d={top:100,left:100};a.initFloatingSidebar=c}(b=a.floatingSidebar||(a.floatingSidebar={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";function b(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];a.postMessage({command:b,args:c},"*")}function c(a,c){var d=function(d){var e=c[d];c[d]=function(){for(var f=[],g=0;g<arguments.length;g++)f[g-0]=arguments[g];return b.apply(void 0,[a,d].concat(f)),e.apply(c,f)}};for(var e in c)d(e)}function d(a,b){function d(a){var b=a.data,c=b.command,d=b.args;e[c]&&("requestInit"===c?e.requestInit(f):e[c].apply(e,d))}var e=a,f={init:function(a){},checkGlobal:function(a,b){return{checkId:"dummyCheckId"}},onGlobalCheckRejected:function(){},invalidateRanges:function(a){},onVisibleRangesChanged:function(a){}};c(b.contentWindow,f),addEventListener("message",d,!1)}function e(){function a(a){var c=a.data,d=c.command,e=c.args;b.acrolinxSidebar[d]&&b.acrolinxSidebar[d].apply(b.acrolinxSidebar,e)}var b=window;addEventListener("message",a,!1);var d={requestInit:function(){},onInitFinished:function(a){},configure:function(a){},requestGlobalCheck:function(){},onCheckResult:function(a){},selectRanges:function(a,b){},replaceRanges:function(a,b){},download:function(a){},openWindow:function(a){}};return c(window.parent,d),d}a.connectAcrolinxPluginToMessages=d,a.createPluginMessageAdapter=e}(b=a.messageAdapter||(a.messageAdapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";function b(a){var b=document.createElement("link");return b.rel="stylesheet",b.href=a,b}function c(a){var b=document.createElement("script");return b.src=a,b.type="text/javascript",b.async=!1,b.defer=!1,b}function d(d){void 0===d&&(d=a.SIDEBAR_URL);var e=d,f=function(a){return a.replace(/^.*"(.*)".*$/g,e+"$1")};a.fetch(e+"index.html",function(a){var d=a.replace(/<!--[\s\S]*?-->/g,""),e=document.querySelector("head"),g=d.match(/href=".*?"/g).map(f);g.forEach(function(a){e.appendChild(b(a))});var h=d.match(/src=".*?"/g).map(f);h.forEach(function(a){e.appendChild(c(a))})})}function e(b,c,d){var e=b.sidebarUrl||a.SIDEBAR_URL,f=e+"index.html";b.useMessageAdapter?(c.addEventListener("load",d),c.src=f):a.fetch(f,function(a){var b=c.contentWindow,f=a.replace(/src="/g,'src="'+e).replace(/href="/g,'href="'+e);b.document.open(),b.document.write(f),b.document.close(),d()})}a.SIDEBAR_URL="https://acrolinx-sidebar-classic.s3.amazonaws.com/v14/prod/",a.loadSidebarCode=d,a.loadSidebarIntoIFrame=e}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){"use strict";function c(a){return void 0!==a.then}function d(a,b){function d(){function b(){e.init(f.assign({},{showServerSelector:!0,clientComponents:k},a))}function d(a,b,c){if(a.hasOwnProperty("error"))window.alert(a.error);else{var d=e.checkGlobal(a.html,{inputFormat:b||"HTML",requestDescription:{documentReference:c||"filename.html"}});l.registerCheckCall(d)}}var e,i={requestInit:function(a){e=a||j.acrolinxSidebar,console.log("requestInit"),b()},onInitFinished:function(a){console.log("onInitFinished: ",a),a.error&&window.alert(a.error.message)},configure:function(a){console.log("configure: ",a)},requestGlobalCheck:function(){console.log("requestGlobalCheck");var a=l.extractHTMLForCheck(),b=l.getFormat?l.getFormat():null,e=l.getDocumentReference?l.getDocumentReference():null;c(a)?a.then(function(a){d(a,b,e)}):d(a,b,e)},onCheckResult:function(a){return l.registerCheckResult(a)},selectRanges:function(a,b){console.log("selectRanges: ",a,b);try{l.selectRanges(a,b)}catch(c){console.log(c),e.invalidateRanges(b.map(function(b){return{checkId:a,range:b.range}}))}},replaceRanges:function(a,b){console.log("replaceRanges: ",a,b);try{l.replaceRanges(a,b)}catch(c){console.log(c),e.invalidateRanges(b.map(function(b){return{checkId:a,range:b.range}}))}},download:function(a){console.log("download: ",a.url,a),window.open(a.url)},openWindow:function(a){var b=a.url;window.open(b)}};console.log("Install acrolinxPlugin in sidebar."),a.useMessageAdapter?h(i,g):j.acrolinxPlugin=i}var e=document.getElementById(a.sidebarContainerId);if(!e)throw new Error("Acrolinx can't find an element with the configured sidebarContainerId \""+a.sidebarContainerId+'".');var g=document.createElement("iframe");e.appendChild(g);var j=g.contentWindow,l=b;i(a,g,d)}function e(c){var d=f.assign({},c,{sidebarContainerId:b.floatingSidebar.SIDEBAR_CONTAINER_ID});g();var e=new a.plugins.AcrolinxPlugin(d);e.registerAdapter(new j(d)),e.init()}var f=acrolinxLibs._,g=a.plugins.floatingSidebar.initFloatingSidebar,h=a.plugins.messageAdapter.connectAcrolinxPluginToMessages,i=a.plugins.utils.loadSidebarIntoIFrame,j=a.plugins.adapter.AutoBindAdapter,k=[{id:"com.acrolinx.sidebarexample",name:"Acrolinx Sidebar Example Client",version:"1.2.3.999",category:"MAIN"}],l=function(){function a(a){this.config=a}return a.prototype.registerAdapter=function(a){this.adapter=a},a.prototype.init=function(){d(this.config,this.adapter)},a}();b.AcrolinxPlugin=l,b.autoBindFloatingSidebar=e}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return{text:a,domPositions:b}}function c(a){return{text:a.map(function(a){return a.text}).join(""),domPositions:g.flatten(a.map(function(a){return a.domPositions}))}}function d(a,b){return{node:a,offset:b}}function e(a){return c(g.map(a.childNodes,function(a){switch(a.nodeType){case Node.ELEMENT_NODE:return e(a);case Node.TEXT_NODE:default:return b(a.textContent,g.times(a.textContent.length,function(b){return d(a,b)}))}}))}function f(a,b){var c=b[Math.max(Math.min(a,b.length)-1,0)];return{node:c.node,offset:c.offset+1}}var g=acrolinxLibs._;a.textMapping=b,a.concatTextMappings=c,a.domPosition=d,a.extractTextDomMapping=e,a.getEndDomPos=f}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));
//# sourceMappingURL=acrolinx-sidebar-integration.min.js.map