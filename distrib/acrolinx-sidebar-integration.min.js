var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var e=-1,f=1,g=0;d.Diff,d.prototype.diff_main=function(a,b,c,d){"undefined"==typeof d&&(d=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var e=d;if(null==a||null==b)throw new Error("Null input. (diff_main)");if(a==b)return a?[[g,a]]:[];"undefined"==typeof c&&(c=!0);var f=c,h=this.diff_commonPrefix(a,b),i=a.substring(0,h);a=a.substring(h),b=b.substring(h),h=this.diff_commonSuffix(a,b);var j=a.substring(a.length-h);a=a.substring(0,a.length-h),b=b.substring(0,b.length-h);var k=this.diff_compute_(a,b,f,e);return i&&k.unshift([g,i]),j&&k.push([g,j]),this.diff_cleanupMerge(k),k},d.prototype.diff_compute_=function(a,b,c,d){var h;if(!a)return[[f,b]];if(!b)return[[e,a]];var i=a.length>b.length?a:b,j=a.length>b.length?b:a,k=i.indexOf(j);if(-1!=k)return h=[[f,i.substring(0,k)],[g,j],[f,i.substring(k+j.length)]],a.length>b.length&&(h[0][0]=h[2][0]=e),h;if(1==j.length)return[[e,a],[f,b]];var l=this.diff_halfMatch_(a,b);if(l){var m=l[0],n=l[1],o=l[2],p=l[3],q=l[4],r=this.diff_main(m,o,c,d),s=this.diff_main(n,p,c,d);return r.concat([[g,q]],s)}return c&&a.length>100&&b.length>100?this.diff_lineMode_(a,b,d):this.diff_bisect_(a,b,d)},d.prototype.diff_lineMode_=function(a,b,c){var d=this.diff_linesToChars_(a,b);a=d.chars1,b=d.chars2;var h=d.lineArray,i=this.diff_main(a,b,!1,c);this.diff_charsToLines_(i,h),this.diff_cleanupSemantic(i),i.push([g,""]);for(var j=0,k=0,l=0,m="",n="";j<i.length;){switch(i[j][0]){case f:l++,n+=i[j][1];break;case e:k++,m+=i[j][1];break;case g:if(k>=1&&l>=1){i.splice(j-k-l,k+l),j=j-k-l;for(var d=this.diff_main(m,n,!1,c),o=d.length-1;o>=0;o--)i.splice(j,0,d[o]);j+=d.length}l=0,k=0,m="",n=""}j++}return i.pop(),i},d.prototype.diff_bisect_=function(a,b,c){for(var d=a.length,g=b.length,h=Math.ceil((d+g)/2),i=h,j=2*h,k=new Array(j),l=new Array(j),m=0;j>m;m++)k[m]=-1,l[m]=-1;k[i+1]=0,l[i+1]=0;for(var n=d-g,o=n%2!=0,p=0,q=0,r=0,s=0,t=0;h>t&&!((new Date).getTime()>c);t++){for(var u=-t+p;t-q>=u;u+=2){var v,w=i+u;v=u==-t||u!=t&&k[w-1]<k[w+1]?k[w+1]:k[w-1]+1;for(var x=v-u;d>v&&g>x&&a.charAt(v)==b.charAt(x);)v++,x++;if(k[w]=v,v>d)q+=2;else if(x>g)p+=2;else if(o){var y=i+n-u;if(y>=0&&j>y&&-1!=l[y]){var z=d-l[y];if(v>=z)return this.diff_bisectSplit_(a,b,v,x,c)}}}for(var A=-t+r;t-s>=A;A+=2){var z,y=i+A;z=A==-t||A!=t&&l[y-1]<l[y+1]?l[y+1]:l[y-1]+1;for(var B=z-A;d>z&&g>B&&a.charAt(d-z-1)==b.charAt(g-B-1);)z++,B++;if(l[y]=z,z>d)s+=2;else if(B>g)r+=2;else if(!o){var w=i+n-A;if(w>=0&&j>w&&-1!=k[w]){var v=k[w],x=i+v-w;if(z=d-z,v>=z)return this.diff_bisectSplit_(a,b,v,x,c)}}}}return[[e,a],[f,b]]},d.prototype.diff_bisectSplit_=function(a,b,c,d,e){var f=a.substring(0,c),g=b.substring(0,d),h=a.substring(c),i=b.substring(d),j=this.diff_main(f,g,!1,e),k=this.diff_main(h,i,!1,e);return j.concat(k)},d.prototype.diff_linesToChars_=function(a,b){function c(a){for(var b="",c=0,f=-1,g=d.length;f<a.length-1;){f=a.indexOf("\n",c),-1==f&&(f=a.length-1);var h=a.substring(c,f+1);c=f+1,(e.hasOwnProperty?e.hasOwnProperty(h):void 0!==e[h])?b+=String.fromCharCode(e[h]):(b+=String.fromCharCode(g),e[h]=g,d[g++]=h)}return b}var d=[],e={};d[0]="";var f=c(a),g=c(b);return{chars1:f,chars2:g,lineArray:d}},d.prototype.diff_charsToLines_=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c][1],e=[],f=0;f<d.length;f++)e[f]=b[d.charCodeAt(f)];a[c][1]=e.join("")}},d.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(f,e)==b.substring(f,e)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e},d.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e},d.prototype.diff_commonOverlap_=function(a,b){var c=a.length,d=b.length;if(0==c||0==d)return 0;c>d?a=a.substring(c-d):d>c&&(b=b.substring(0,c));var e=Math.min(c,d);if(a==b)return e;for(var f=0,g=1;;){var h=a.substring(e-g),i=b.indexOf(h);if(-1==i)return f;g+=i,(0==i||a.substring(e-g)==b.substring(0,g))&&(f=g,g++)}},d.prototype.diff_halfMatch_=function(a,b){function c(a,b,c){for(var d,e,f,h,i=a.substring(c,c+Math.floor(a.length/4)),j=-1,k="";-1!=(j=b.indexOf(i,j+1));){var l=g.diff_commonPrefix(a.substring(c),b.substring(j)),m=g.diff_commonSuffix(a.substring(0,c),b.substring(0,j));k.length<m+l&&(k=b.substring(j-m,j)+b.substring(j,j+l),d=a.substring(0,c-m),e=a.substring(c+l),f=b.substring(0,j-m),h=b.substring(j+l))}return 2*k.length>=a.length?[d,e,f,h,k]:null}if(this.Diff_Timeout<=0)return null;var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||2*e.length<d.length)return null;var f,g=this,h=c(d,e,Math.ceil(d.length/4)),i=c(d,e,Math.ceil(d.length/2));if(!h&&!i)return null;f=i?h&&h[4].length>i[4].length?h:i:h;var j,k,l,m;a.length>b.length?(j=f[0],k=f[1],l=f[2],m=f[3]):(l=f[0],m=f[1],j=f[2],k=f[3]);var n=f[4];return[j,k,l,m,n]},d.prototype.diff_cleanupSemantic=function(a){for(var b=!1,c=[],d=0,h=null,i=0,j=0,k=0,l=0,m=0;i<a.length;)a[i][0]==g?(c[d++]=i,j=l,k=m,l=0,m=0,h=a[i][1]):(a[i][0]==f?l+=a[i][1].length:m+=a[i][1].length,h&&h.length<=Math.max(j,k)&&h.length<=Math.max(l,m)&&(a.splice(c[d-1],0,[e,h]),a[c[d-1]+1][0]=f,d--,d--,i=d>0?c[d-1]:-1,j=0,k=0,l=0,m=0,h=null,b=!0)),i++;for(b&&this.diff_cleanupMerge(a),this.diff_cleanupSemanticLossless(a),i=1;i<a.length;){if(a[i-1][0]==e&&a[i][0]==f){var n=a[i-1][1],o=a[i][1],p=this.diff_commonOverlap_(n,o),q=this.diff_commonOverlap_(o,n);p>=q?(p>=n.length/2||p>=o.length/2)&&(a.splice(i,0,[g,o.substring(0,p)]),a[i-1][1]=n.substring(0,n.length-p),a[i+1][1]=o.substring(p),i++):(q>=n.length/2||q>=o.length/2)&&(a.splice(i,0,[g,n.substring(0,q)]),a[i-1][0]=f,a[i-1][1]=o.substring(0,o.length-q),a[i+1][0]=e,a[i+1][1]=n.substring(q),i++),i++}i++}},d.prototype.diff_cleanupSemanticLossless=function(a){function b(a,b){if(!a||!b)return 6;var c=a.charAt(a.length-1),e=b.charAt(0),f=c.match(d.nonAlphaNumericRegex_),g=e.match(d.nonAlphaNumericRegex_),h=f&&c.match(d.whitespaceRegex_),i=g&&e.match(d.whitespaceRegex_),j=h&&c.match(d.linebreakRegex_),k=i&&e.match(d.linebreakRegex_),l=j&&a.match(d.blanklineEndRegex_),m=k&&b.match(d.blanklineStartRegex_);return l||m?5:j||k?4:f&&!h&&i?3:h||i?2:f||g?1:0}for(var c=1;c<a.length-1;){if(a[c-1][0]==g&&a[c+1][0]==g){var e=a[c-1][1],f=a[c][1],h=a[c+1][1],i=this.diff_commonSuffix(e,f);if(i){var j=f.substring(f.length-i);e=e.substring(0,e.length-i),f=j+f.substring(0,f.length-i),h=j+h}for(var k=e,l=f,m=h,n=b(e,f)+b(f,h);f.charAt(0)===h.charAt(0);){e+=f.charAt(0),f=f.substring(1)+h.charAt(0),h=h.substring(1);var o=b(e,f)+b(f,h);o>=n&&(n=o,k=e,l=f,m=h)}a[c-1][1]!=k&&(k?a[c-1][1]=k:(a.splice(c-1,1),c--),a[c][1]=l,m?a[c+1][1]=m:(a.splice(c+1,1),c--))}c++}},d.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,d.whitespaceRegex_=/\s/,d.linebreakRegex_=/[\r\n]/,d.blanklineEndRegex_=/\n\r?\n$/,d.blanklineStartRegex_=/^\r?\n\r?\n/,d.prototype.diff_cleanupEfficiency=function(a){for(var b=!1,c=[],d=0,h=null,i=0,j=!1,k=!1,l=!1,m=!1;i<a.length;)a[i][0]==g?(a[i][1].length<this.Diff_EditCost&&(l||m)?(c[d++]=i,j=l,k=m,h=a[i][1]):(d=0,h=null),l=m=!1):(a[i][0]==e?m=!0:l=!0,h&&(j&&k&&l&&m||h.length<this.Diff_EditCost/2&&j+k+l+m==3)&&(a.splice(c[d-1],0,[e,h]),a[c[d-1]+1][0]=f,d--,h=null,j&&k?(l=m=!0,d=0):(d--,i=d>0?c[d-1]:-1,l=m=!1),b=!0)),i++;b&&this.diff_cleanupMerge(a)},d.prototype.diff_cleanupMerge=function(a){a.push([g,""]);for(var b,c=0,d=0,h=0,i="",j="";c<a.length;)switch(a[c][0]){case f:h++,j+=a[c][1],c++;break;case e:d++,i+=a[c][1],c++;break;case g:d+h>1?(0!==d&&0!==h&&(b=this.diff_commonPrefix(j,i),0!==b&&(c-d-h>0&&a[c-d-h-1][0]==g?a[c-d-h-1][1]+=j.substring(0,b):(a.splice(0,0,[g,j.substring(0,b)]),c++),j=j.substring(b),i=i.substring(b)),b=this.diff_commonSuffix(j,i),0!==b&&(a[c][1]=j.substring(j.length-b)+a[c][1],j=j.substring(0,j.length-b),i=i.substring(0,i.length-b))),0===d?a.splice(c-h,d+h,[f,j]):0===h?a.splice(c-d,d+h,[e,i]):a.splice(c-d-h,d+h,[e,i],[f,j]),c=c-d-h+(d?1:0)+(h?1:0)+1):0!==c&&a[c-1][0]==g?(a[c-1][1]+=a[c][1],a.splice(c,1)):c++,h=0,d=0,i="",j=""}""===a[a.length-1][1]&&a.pop();var k=!1;for(c=1;c<a.length-1;)a[c-1][0]==g&&a[c+1][0]==g&&(a[c][1].substring(a[c][1].length-a[c-1][1].length)==a[c-1][1]?(a[c][1]=a[c-1][1]+a[c][1].substring(0,a[c][1].length-a[c-1][1].length),a[c+1][1]=a[c-1][1]+a[c+1][1],a.splice(c-1,1),k=!0):a[c][1].substring(0,a[c+1][1].length)==a[c+1][1]&&(a[c-1][1]+=a[c+1][1],a[c][1]=a[c][1].substring(a[c+1][1].length)+a[c+1][1],a.splice(c+1,1),k=!0)),c++;k&&this.diff_cleanupMerge(a)},d.prototype.diff_xIndex=function(a,b){var c,d=0,g=0,h=0,i=0;for(c=0;c<a.length&&(a[c][0]!==f&&(d+=a[c][1].length),a[c][0]!==e&&(g+=a[c][1].length),!(d>b));c++)h=d,i=g;return a.length!=c&&a[c][0]===e?i:i+(b-h)},d.prototype.diff_prettyHtml=function(a){for(var b=[],c=/&/g,d=/</g,h=/>/g,i=/\n/g,j=0;j<a.length;j++){var k=a[j][0],l=a[j][1],m=l.replace(c,"&amp;").replace(d,"&lt;").replace(h,"&gt;").replace(i,"&para;<br>");switch(k){case f:b[j]='<ins style="background:#e6ffe6;">'+m+"</ins>";break;case e:b[j]='<del style="background:#ffe6e6;">'+m+"</del>";break;case g:b[j]="<span>"+m+"</span>"}}return b.join("")},d.prototype.diff_text1=function(a){for(var b=[],c=0;c<a.length;c++)a[c][0]!==f&&(b[c]=a[c][1]);return b.join("")},d.prototype.diff_text2=function(a){for(var b=[],c=0;c<a.length;c++)a[c][0]!==e&&(b[c]=a[c][1]);return b.join("")},d.prototype.diff_levenshtein=function(a){for(var b=0,c=0,d=0,h=0;h<a.length;h++){var i=a[h][0],j=a[h][1];switch(i){case f:c+=j.length;break;case e:d+=j.length;break;case g:b+=Math.max(c,d),c=0,d=0}}return b+=Math.max(c,d)},d.prototype.diff_toDelta=function(a){for(var b=[],c=0;c<a.length;c++)switch(a[c][0]){case f:b[c]="+"+encodeURI(a[c][1]);break;case e:b[c]="-"+a[c][1].length;break;case g:b[c]="="+a[c][1].length}return b.join("	").replace(/%20/g," ")},d.prototype.diff_fromDelta=function(a,b){for(var c=[],d=0,h=0,i=b.split(/\t/g),j=0;j<i.length;j++){var k=i[j].substring(1);switch(i[j].charAt(0)){case"+":try{c[d++]=[f,decodeURI(k)]}catch(l){throw new Error("Illegal escape in diff_fromDelta: "+k)}break;case"-":case"=":var m=parseInt(k,10);if(isNaN(m)||0>m)throw new Error("Invalid number in diff_fromDelta: "+k);var n=a.substring(h,h+=m);"="==i[j].charAt(0)?c[d++]=[g,n]:c[d++]=[e,n];break;default:if(i[j])throw new Error("Invalid diff operation in diff_fromDelta: "+i[j])}}if(h!=a.length)throw new Error("Delta length ("+h+") does not equal source text length ("+a.length+").");return c},d.prototype.match_main=function(a,b,c){if(null==a||null==b||null==c)throw new Error("Null input. (match_main)");return c=Math.max(0,Math.min(c,a.length)),a==b?0:a.length?a.substring(c,c+b.length)==b?c:this.match_bitap_(a,b,c):-1},d.prototype.match_bitap_=function(a,b,c){function d(a,d){var e=a/b.length,g=Math.abs(c-d);return f.Match_Distance?e+g/f.Match_Distance:g?1:e}if(b.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var e=this.match_alphabet_(b),f=this,g=this.Match_Threshold,h=a.indexOf(b,c);-1!=h&&(g=Math.min(d(0,h),g),h=a.lastIndexOf(b,c+b.length),-1!=h&&(g=Math.min(d(0,h),g)));var i=1<<b.length-1;h=-1;for(var j,k,l,m=b.length+a.length,n=0;n<b.length;n++){for(j=0,k=m;k>j;)d(n,c+k)<=g?j=k:m=k,k=Math.floor((m-j)/2+j);m=k;var o=Math.max(1,c-k+1),p=Math.min(c+k,a.length)+b.length,q=Array(p+2);q[p+1]=(1<<n)-1;for(var r=p;r>=o;r--){var s=e[a.charAt(r-1)];if(0===n?q[r]=(q[r+1]<<1|1)&s:q[r]=(q[r+1]<<1|1)&s|((l[r+1]|l[r])<<1|1)|l[r+1],q[r]&i){var t=d(n,r-1);if(g>=t){if(g=t,h=r-1,!(h>c))break;o=Math.max(1,2*c-h)}}}if(d(n+1,c)>g)break;l=q}return h},d.prototype.match_alphabet_=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=0;for(var c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b},d.prototype.patch_addContext_=function(a,b){if(0!=b.length){for(var c=b.substring(a.start2,a.start2+a.length1),d=0;b.indexOf(c)!=b.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)d+=this.Patch_Margin,c=b.substring(a.start2-d,a.start2+a.length1+d);d+=this.Patch_Margin;var e=b.substring(a.start2-d,a.start2);e&&a.diffs.unshift([g,e]);var f=b.substring(a.start2+a.length1,a.start2+a.length1+d);f&&a.diffs.push([g,f]),a.start1-=e.length,a.start2-=e.length,a.length1+=e.length+f.length,a.length2+=e.length+f.length}},d.prototype.patch_make=function(a,b,c){var h,i;if("string"==typeof a&&"string"==typeof b&&"undefined"==typeof c)h=a,i=this.diff_main(h,b,!0),i.length>2&&(this.diff_cleanupSemantic(i),this.diff_cleanupEfficiency(i));else if(a&&"object"==typeof a&&"undefined"==typeof b&&"undefined"==typeof c)i=a,h=this.diff_text1(i);else if("string"==typeof a&&b&&"object"==typeof b&&"undefined"==typeof c)h=a,i=b;else{if("string"!=typeof a||"string"!=typeof b||!c||"object"!=typeof c)throw new Error("Unknown call format to patch_make.");h=a,i=c}if(0===i.length)return[];for(var j=[],k=new d.patch_obj,l=0,m=0,n=0,o=h,p=h,q=0;q<i.length;q++){var r=i[q][0],s=i[q][1];switch(l||r===g||(k.start1=m,k.start2=n),r){case f:k.diffs[l++]=i[q],k.length2+=s.length,p=p.substring(0,n)+s+p.substring(n);break;case e:k.length1+=s.length,k.diffs[l++]=i[q],p=p.substring(0,n)+p.substring(n+s.length);break;case g:s.length<=2*this.Patch_Margin&&l&&i.length!=q+1?(k.diffs[l++]=i[q],k.length1+=s.length,k.length2+=s.length):s.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(k,o),j.push(k),k=new d.patch_obj,l=0,o=p,m=n)}r!==f&&(m+=s.length),r!==e&&(n+=s.length)}return l&&(this.patch_addContext_(k,o),j.push(k)),j},d.prototype.patch_deepCopy=function(a){for(var b=[],c=0;c<a.length;c++){var e=a[c],f=new d.patch_obj;f.diffs=[];for(var g=0;g<e.diffs.length;g++)f.diffs[g]=e.diffs[g].slice();f.start1=e.start1,f.start2=e.start2,f.length1=e.length1,f.length2=e.length2,b[c]=f}return b},d.prototype.patch_apply=function(a,b){if(0==a.length)return[b,[]];a=this.patch_deepCopy(a);var c=this.patch_addPadding(a);b=c+b+c,this.patch_splitMax(a);for(var d=0,h=[],i=0;i<a.length;i++){var j,k=a[i].start2+d,l=this.diff_text1(a[i].diffs),m=-1;if(l.length>this.Match_MaxBits?(j=this.match_main(b,l.substring(0,this.Match_MaxBits),k),-1!=j&&(m=this.match_main(b,l.substring(l.length-this.Match_MaxBits),k+l.length-this.Match_MaxBits),(-1==m||j>=m)&&(j=-1))):j=this.match_main(b,l,k),-1==j)h[i]=!1,d-=a[i].length2-a[i].length1;else{h[i]=!0,d=j-k;var n;if(n=-1==m?b.substring(j,j+l.length):b.substring(j,m+this.Match_MaxBits),l==n)b=b.substring(0,j)+this.diff_text2(a[i].diffs)+b.substring(j+l.length);else{var o=this.diff_main(l,n,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(o)/l.length>this.Patch_DeleteThreshold)h[i]=!1;else{this.diff_cleanupSemanticLossless(o);for(var p,q=0,r=0;r<a[i].diffs.length;r++){var s=a[i].diffs[r];s[0]!==g&&(p=this.diff_xIndex(o,q)),s[0]===f?b=b.substring(0,j+p)+s[1]+b.substring(j+p):s[0]===e&&(b=b.substring(0,j+p)+b.substring(j+this.diff_xIndex(o,q+s[1].length))),s[0]!==e&&(q+=s[1].length)}}}}}return b=b.substring(c.length,b.length-c.length),[b,h]},d.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,c="",d=1;b>=d;d++)c+=String.fromCharCode(d);for(var d=0;d<a.length;d++)a[d].start1+=b,a[d].start2+=b;var e=a[0],f=e.diffs;if(0==f.length||f[0][0]!=g)f.unshift([g,c]),e.start1-=b,e.start2-=b,e.length1+=b,e.length2+=b;else if(b>f[0][1].length){var h=b-f[0][1].length;f[0][1]=c.substring(f[0][1].length)+f[0][1],e.start1-=h,e.start2-=h,e.length1+=h,e.length2+=h}if(e=a[a.length-1],f=e.diffs,0==f.length||f[f.length-1][0]!=g)f.push([g,c]),e.length1+=b,e.length2+=b;else if(b>f[f.length-1][1].length){var h=b-f[f.length-1][1].length;f[f.length-1][1]+=c.substring(0,h),e.length1+=h,e.length2+=h}return c},d.prototype.patch_splitMax=function(a){for(var b=this.Match_MaxBits,c=0;c<a.length;c++)if(!(a[c].length1<=b)){var h=a[c];a.splice(c--,1);for(var i=h.start1,j=h.start2,k="";0!==h.diffs.length;){var l=new d.patch_obj,m=!0;for(l.start1=i-k.length,l.start2=j-k.length,""!==k&&(l.length1=l.length2=k.length,l.diffs.push([g,k]));0!==h.diffs.length&&l.length1<b-this.Patch_Margin;){var n=h.diffs[0][0],o=h.diffs[0][1];n===f?(l.length2+=o.length,j+=o.length,l.diffs.push(h.diffs.shift()),m=!1):n===e&&1==l.diffs.length&&l.diffs[0][0]==g&&o.length>2*b?(l.length1+=o.length,i+=o.length,m=!1,l.diffs.push([n,o]),h.diffs.shift()):(o=o.substring(0,b-l.length1-this.Patch_Margin),l.length1+=o.length,i+=o.length,n===g?(l.length2+=o.length,j+=o.length):m=!1,l.diffs.push([n,o]),o==h.diffs[0][1]?h.diffs.shift():h.diffs[0][1]=h.diffs[0][1].substring(o.length))}k=this.diff_text2(l.diffs),k=k.substring(k.length-this.Patch_Margin);var p=this.diff_text1(h.diffs).substring(0,this.Patch_Margin);""!==p&&(l.length1+=p.length,l.length2+=p.length,0!==l.diffs.length&&l.diffs[l.diffs.length-1][0]===g?l.diffs[l.diffs.length-1][1]+=p:l.diffs.push([g,p])),m||a.splice(++c,0,l)}}},d.prototype.patch_toText=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b.join("")},d.prototype.patch_fromText=function(a){var b=[];if(!a)return b;for(var c=a.split("\n"),h=0,i=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;h<c.length;){var j=c[h].match(i);if(!j)throw new Error("Invalid patch string: "+c[h]);var k=new d.patch_obj;for(b.push(k),k.start1=parseInt(j[1],10),""===j[2]?(k.start1--,k.length1=1):"0"==j[2]?k.length1=0:(k.start1--,k.length1=parseInt(j[2],10)),k.start2=parseInt(j[3],10),""===j[4]?(k.start2--,k.length2=1):"0"==j[4]?k.length2=0:(k.start2--,k.length2=parseInt(j[4],10)),h++;h<c.length;){var l=c[h].charAt(0);try{var m=decodeURI(c[h].substring(1))}catch(n){throw new Error("Illegal escape in patch_fromText: "+m)}if("-"==l)k.diffs.push([e,m]);else if("+"==l)k.diffs.push([f,m]);else if(" "==l)k.diffs.push([g,m]);else{if("@"==l)break;if(""!==l)throw new Error('Invalid patch mode "'+l+'" in: '+m)}h++}}return b},d.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},d.patch_obj.prototype.toString=function(){var a,b;a=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,b=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var c,d=["@@ -"+a+" +"+b+" @@\n"],h=0;h<this.diffs.length;h++){switch(this.diffs[h][0]){case f:c="+";break;case e:c="-";break;case g:c=" "}d[h+1]=c+encodeURI(this.diffs[h][1])+"\n"}return d.join("").replace(/%20/g," ")},b.exports=d,b.exports.diff_match_patch=d,b.exports.DIFF_DELETE=e,b.exports.DIFF_INSERT=f,b.exports.DIFF_EQUAL=g},{}],2:[function(a,b,c){!function(b){var c=a("diff-match-patch");b.diffMatchPatch={DiffMatchPatch:c.diff_match_patch,DIFF_DELETE:c.DIFF_DELETE,DIFF_INSERT:c.DIFF_INSERT,DIFF_EQUAL:c.DIFF_EQUAL}}(acrolinx||(acrolinx={}))},{"diff-match-patch":1}]},{},[2]);var acrolinxLibs;!function(a){"use strict";var b=window,c=b.acrolinxLibs||{};a.Q=c.Q||b.Q,a._=c._||b._}(acrolinxLibs||(acrolinxLibs={}));var acrolinx;!function(a){var b;!function(a){"use strict";a.SoftwareComponentCategory={MAIN:"MAIN",DEFAULT:"DEFAULT",DETAIL:"DETAIL"},a.ErrorCodes={checkIsAlreadyRunning:"checkIsAlreadyRunning",userIsNotLoggedIn:"userIsNotLoggedIn",sidebarNotReadyForCheck:"sidebarNotReadyForCheck",checkCanceledByUser:"checkCanceledByUser",base64EncodedGzippedUnsupported:"base64EncodedGzippedUnsupported"}}(b=a.sidebar||(a.sidebar={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];d&&console.log.apply(console,[a].concat(b))}function c(){d=!0}var d=!1;a.log=b,a.enableLogging=c}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a,b){if(0===a.length)return 0;var c=d.sortedIndexBy(a,{diffOffset:0,oldPosition:b+.1},function(a){return a.oldPosition});return c>0?a[c-1].diffOffset:0}function c(a,c){return c+b(a,c)}var d=acrolinxLibs._;a.findDisplacement=b,a.findNewIndex=c}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){function b(a){var b=new RegExp(j,"ig"),e=[],f=0,g=a.replace(b,function(a,b,g,h){var i=d.startsWith(a,"&")?c(a):"";return f-=a.length-i.length,e.push({oldPosition:h+a.length,diffOffset:f}),i});return[g,e]}function c(a){var b=document.createElement("div");return b.innerHTML=a,b.textContent}var d=acrolinxLibs._,e="<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*</script>",f="<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*</style>",g="<([^>]+)>",h="&.*?;",i=[e,f,g,h],j="("+i.join("|")+")";a.extractText=b}(b=a.textextraction||(a.textextraction={}))}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){"use strict";function c(a){var b=[],c=0,d=0;return a.forEach(function(a){var e=a[0],f=a[1];switch(e){case k:c+=f.length;break;case l:c+=f.length,d-=f.length;break;case m:d+=f.length;break;default:throw new Error("Illegal Diff Action: "+e)}b.push({oldPosition:c,diffOffset:d})}),b}function d(a,b){return a.slice(b.range[0],b.range[1])}function e(a,b,e,j){if(void 0===j&&(j="HTML"),f.isEmpty(e))return[];var k="HTML"===j?i(a):[a,[]],l=k[0],m=k[1],o=n.diff_main(l,b),p=c(o),q=e.map(function(a){var b=h(m,a.range[0]),c=h(m,a.range[1]),d=h(p,b),e=c-1,f=h(p,e)+1;return{originalMatch:a,range:[d,f]}}),r=f.some(q,function(a){return d(b,a)!==a.originalMatch.content});return g("checkedDocument",a),g("cleanedCheckedDocument",l),g("cleanedCheckedDocumentCodes",l.split("").map(function(a){return a.charCodeAt(0)})),g("currentDocument",b),g("currentDocumentCodes",b.split("").map(function(a){return a.charCodeAt(0)})),g("matches",e),g("diffs",o),g("alignedMatches",q),g("alignedMatchesContent",q.map(function(a){return d(b,a)})),r?[]:q}var f=acrolinxLibs._,g=a.plugins.utils.log,h=a.plugins.utils.findNewIndex,i=a.plugins.utils.textextraction.extractText,j=a.diffMatchPatch,k=j.DIFF_EQUAL,l=j.DIFF_DELETE,m=j.DIFF_INSERT,n=new a.diffMatchPatch.DiffMatchPatch;b.createOffsetMappingArray=c,b.lookupMatches=e}(c=b.diffbased||(b.diffbased={}))}(c=b.lookup||(b.lookup={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a,b){var c=Date.now(),d=b();return console.log('Duration of "'+a+':"',Date.now()-c),d}function c(a){return a[a.length-1].range[1]-a[0].range[0]}function d(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onload=function(){if(!(c.status>=200&&c.status<400))throw new Error("Error while loading "+a+".");b(c.responseText)},c.onerror=function(){throw new Error("Error while loading "+a+".")},c.send()}function e(a){return"IFRAME"===a.nodeName}function f(a){a.dispatchEvent(new CustomEvent("input"))}function g(a){var b=document.createElement("a");b.href=a,""===b.host&&(b.href=b.href);var c=b.protocol,d=b.host,e=b.hostname,f=b.port,g=b.pathname,h=b.hash;return{protocol:c,host:d,hostname:e,port:f,pathname:g,hash:h}}function h(a){var b=g(a),c=b.protocol,d=b.host;return location.protocol===c&&location.host===d}function i(a){return j.zipObject(a,a.map(j.constant(!0)))}var j=acrolinxLibs._;a.logTime=b,a.getCompleteFlagLength=c,a.fetch=d,a.isIFrame=e,a.fakeInputEvent=f,a.parseUrl=g,a.isFromSameOrigin=h,a.toSet=i}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(c){"use strict";var d=a.plugins.lookup.diffbased.lookupMatches,e=acrolinxLibs._,f=a.plugins.utils.getCompleteFlagLength,g=a.plugins.utils.fakeInputEvent,h=function(){function a(a){this.config=a}return a.prototype.getEditorElement=function(){return this.getEditorDocument().querySelector("body")},a.prototype.registerCheckCall=function(a){},a.prototype.registerCheckResult=function(a){this.isCheckingNow=!1,this.currentHtmlChecking=this.html,this.prevCheckedHtml=this.currentHtmlChecking},a.prototype.extractContentForCheck=function(){return this.html=this.getContent(),this.currentHtmlChecking=this.html,{content:this.html}},a.prototype.scrollIntoView=function(a){var b=a.getRangeAt(0),c=b.cloneRange();c.collapse(!1);var d=document.createElement("span");c.insertNode(d),d.scrollIntoView(),this.scrollElementIntoView(d),d.remove()},a.prototype.scrollToCurrentSelection=function(){var a=this.getEditorDocument().getSelection();if(a)try{this.scrollIntoView(a)}catch(b){console.log("Scrolling Error: ",b)}},a.prototype.scrollElementIntoView=function(a){a.scrollIntoView()},a.prototype.selectRanges=function(a,b){this.selectMatches(a,b),this.scrollToCurrentSelection()},a.prototype.selectMatches=function(a,b){var c=this.getTextDomMapping(),f=d(this.currentHtmlChecking,c.text,b);if(e.isEmpty(f))throw new Error("Selected flagged content is modified.");return this.selectAlignedMatches(f,c),[f,c]},a.prototype.selectAlignedMatches=function(a,b){var c=a[0].range[0],d=f(a);this.selectText(c,d,b)},a.prototype.selectText=function(a,b,c){if(c.text){var d=this.getEditorDocument(),e=d.getSelection();e.removeAllRanges(),e.addRange(this.createRange(a,b,c))}},a.prototype.createRange=function(a,c,d){var e=this.getEditorDocument(),f=e.createRange(),g=d.domPositions[a],h=b.utils.getEndDomPos(a+c,d.domPositions);return f.setStart(g.node,g.offset),f.setEnd(h.node,h.offset),f},a.prototype.replaceAlignedMatches=function(a){for(var b=this.getEditorDocument(),c=e.clone(a).reverse(),d=0,f=c;d<f.length;d++){var g=f[d],h=this.getTextDomMapping(),i=g.range[1]-g.range[0];if(i>1){var j=this.createRange(g.range[0]+1,i-1,h),k=this.createRange(g.range[0],1,h);j.deleteContents(),k.deleteContents(),k.insertNode(b.createTextNode(g.originalMatch.replacement))}else{var l=this.createRange(g.range[0],i,h);l.deleteContents(),l.insertNode(b.createTextNode(g.originalMatch.replacement))}}},a.prototype.replaceRanges=function(a,b){var c=this.selectMatches(a,b)[0],d=c.map(function(a){return a.originalMatch.replacement}).join("");this.replaceAlignedMatches(c),this.selectText(c[0].range[0],d.length,this.getTextDomMapping()),this.scrollToCurrentSelection(),g(this.getEditorElement())},a.prototype.getTextDomMapping=function(){return b.utils.extractTextDomMapping(this.getEditorElement())},a}();c.AbstractRichtextEditorAdapter=h}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a){return!!a.editorId}function c(a){return!!a.element}function d(a){if(c(a))return a.element;if(b(a))return document.getElementById(a.editorId);throw console.error("Invalid AdapterConf. Missing editorId or element",a),new Error("Invalid AdapterConf. Missing editorId or element")}a.hasEditorID=b,a.hasElement=c,a.getElementFromAdapterConf=d}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";var c=function(){function b(a){this.conf=a}return b.prototype.extractContentForCheck=function(){var b=this;return this.multiAdapter=new a.plugins.adapter.MultiEditorAdapter,a.plugins.autobind.bindAdaptersForCurrentPage(this.conf).forEach(function(a){b.multiAdapter.addSingleAdapter(a)}),this.multiAdapter.extractContentForCheck()},b.prototype.registerCheckCall=function(a){},b.prototype.registerCheckResult=function(a){},b.prototype.selectRanges=function(a,b){this.multiAdapter.selectRanges(a,b)},b.prototype.replaceRanges=function(a,b){this.multiAdapter.replaceRanges(a,b)},b}();b.AutoBindAdapter=c}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(a){function b(b){a.call(this,b),this.editorId=b.editorId}return __extends(b,a),b.prototype.getEditor=function(){return CKEDITOR.instances[this.editorId]},b.prototype.getEditorDocument=function(){return this.getEditor().document.$},b.prototype.getContent=function(){return this.getEditor().getData()},b.prototype.extractContentForCheck=function(){if(this.html=this.getContent(),this.currentHtmlChecking=this.html,this.isInWysiwygMode())""===this.html&&(this.html="<span> </span>");else{if(!this.isCheckingNow)return{error:"Action is not permitted in Source mode."};this.isCheckingNow=!1}return{content:this.html}},b.prototype.selectRanges=function(b,c){this.isInWysiwygMode()?a.prototype.selectRanges.call(this,b,c):window.alert("Action is not permitted in Source mode.")},b.prototype.replaceRanges=function(b,c){this.isInWysiwygMode()?a.prototype.replaceRanges.call(this,b,c):window.alert("Action is not permitted in Source mode.")},b.prototype.isInWysiwygMode=function(){return"wysiwyg"===this.getEditor().mode},b}(a.AbstractRichtextEditorAdapter);a.CKEditorAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a){return a.documentElement||a.body.parentNode||a.body}function c(a){return void 0===a&&(a=window),void 0!==a.pageYOffset?a.pageYOffset:b(a.document).scrollTop}function d(a){return a.clientHeight!==a.scrollHeight&&"BODY"!==a.tagName&&"HTML"!==a.tagName}function e(a){for(var b=[],c=a.parentElement;c;)b.push(c),c=c.parentElement;return b}function f(a){return e(a).filter(d)}function g(a,b,d){if(void 0===b&&(b=0),void 0===d&&(d=0),!b)return void a.scrollIntoView();var e=a.getBoundingClientRect(),g=f(a);g.length<=2&&g.forEach(function(a){var b=a.getBoundingClientRect();(e.top<b.top+d||e.bottom>b.bottom)&&(a.scrollTop=e.top-b.top-d)});var h=c();(e.top<b||e.bottom>window.innerHeight)&&window.scrollTo(0,h+e.top-b)}a.scrollIntoView=g}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";var c=a.plugins.utils.scrollIntoView,d=function(a){function d(c){a.call(this,c),this.element=b.getElementFromAdapterConf(c)}return __extends(d,a),d.prototype.getEditorElement=function(){return this.element},d.prototype.getContent=function(){return this.element.innerHTML},d.prototype.getEditorDocument=function(){return this.element.ownerDocument},d.prototype.scrollElementIntoView=function(a){c(a,this.config.scrollOffsetY)},d}(b.AbstractRichtextEditorAdapter);b.ContentEditableAdapter=d}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";var c=a.plugins.lookup.diffbased.lookupMatches,d=acrolinxLibs._,e=a.plugins.utils.getCompleteFlagLength,f=a.plugins.utils.fakeInputEvent,g=a.plugins.utils.scrollIntoView,h=function(){function a(a){this.element=b.getElementFromAdapterConf(a),this.config=a}return a.prototype.getContent=function(){return this.element.value},a.prototype.getCurrentText=function(){return this.getContent()},a.prototype.getFormat=function(){return"TEXT"},a.prototype.extractContentForCheck=function(){return this.html=this.getContent(),this.currentHtmlChecking=this.html,{content:this.html}},a.prototype.registerCheckResult=function(a){},a.prototype.registerCheckCall=function(a){},a.prototype.scrollAndSelect=function(a){var b=a[0].range[0],c=e(a),d=this.element;if(d.clientHeight<d.scrollHeight){
var f=this.element.value;d.value=f.slice(0,b),d.focus(),d.scrollTop=1e9;var h=d.scrollTop;d.value=f,h>0&&(d.scrollTop=h+d.clientHeight/2)}d.setSelectionRange(b,b+c),d.focus(),g(d,this.config.scrollOffsetY)},a.prototype.selectRanges=function(a,b){this.selectMatches(a,b)},a.prototype.selectMatches=function(a,b){var e=c(this.currentHtmlChecking,this.getCurrentText(),b,"TEXT");if(d.isEmpty(e))throw"Selected flagged content is modified.";return this.scrollAndSelect(e),e},a.prototype.replaceAlignedMatches=function(a){for(var b=d.clone(a).reverse(),c=this.element,e=c.value,f=0,g=b;f<g.length;f++){var h=g[f];e=e.slice(0,h.range[0])+h.originalMatch.replacement+e.slice(h.range[1])}c.value=e},a.prototype.replaceRanges=function(a,b){var c=this.selectMatches(a,b);this.scrollAndSelect(c),this.replaceAlignedMatches(c);var d=c[0].range[0],e=c.map(function(a){return a.originalMatch.replacement}).join("");this.element.setSelectionRange(d,d+e.length),f(this.element)},a}();b.InputAdapter=h}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a){for(var b="",d=[],e=0,f=0;f<a.length;f++){var g=a[f],h=c[g];if(h){var i=h.length-1;e-=i,d.push({oldPosition:b.length+h.length,diffOffset:e})}b+=h||g}return{escapedText:b,backwardAlignment:d}}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};a.escapeHtmlCharacters=b}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";function c(a,b){var c=i.clone(a.attributes);b&&i.assign(c,{id:b});var d=i.map(c,function(a,b){return" "+b+'="'+i.escape(a)+'"'}).join("");return"<"+a.tagName+d+">"}function d(a){return"</"+a+">"}function e(a,b){return[h(a.backwardAlignment,b[0]),h(a.backwardAlignment,b[1])]}function f(a,b){void 0===b&&(b="div");var c=a.tagName||b;return i.includes(c," ")&&console.info('tagName "'+c+'" contains whitespaces which may lead to unexpected results.'),{tagName:c,attributes:a.attributes||{}}}var g=a.plugins.utils.escapeHtmlCharacters,h=a.plugins.utils.findNewIndex,i=acrolinxLibs._,j=function(){function a(a){void 0===a&&(a={}),this.config=a,a.rootElement&&(this.rootElementWrapper=f(a.rootElement,"html")),this.adapters=[]}return a.prototype.addSingleAdapter=function(a,b,c){void 0===b&&(b={}),void 0===c&&(c="acrolinx_integration"+this.adapters.length),this.adapters.push({id:c,adapter:a,wrapper:f(b)})},a.prototype.extractContentForCheck=function(){var a=this,b=acrolinxLibs.Q,e=b.defer(),f=this.adapters.map(function(a){return a.adapter.extractContentForCheck()});return b.all(f).then(function(b){var f=a.config.documentHeader||"";a.rootElementWrapper&&(f+=c(a.rootElementWrapper));for(var h=0;h<a.adapters.length;h++){var i=a.adapters[h],j=i.wrapper.tagName,k=c(i.wrapper,i.id),l=i.adapter.getFormat?"TEXT"===i.adapter.getFormat():!1,m=b[h].content,n=void 0;l?(i.escapeResult=g(m),n=i.escapeResult.escapedText):n=m;var o=k+n+d(j);i.start=f.length+k.length,i.end=f.length+k.length+n.length,f+=o}a.rootElementWrapper&&(f+=d(a.rootElementWrapper.tagName));var p={content:f};e.resolve(p)}),e.promise},a.prototype.registerCheckCall=function(a){},a.prototype.registerCheckResult=function(a){this.checkResult=a,this.adapters.forEach(function(b){b.adapter.registerCheckResult(a)})},a.prototype.selectRanges=function(a,b){var c=this.remapMatches(b);for(var d in c)c[d].adapter.selectRanges(a,c[d].matches)},a.prototype.remapMatches=function(a){for(var b={},c=0,d=a;c<d.length;c++){var f=d[c],g=this.getAdapterForMatch(f);b.hasOwnProperty(g.id)||(b[g.id]={matches:[],adapter:g.adapter});var h=i.clone(f),j=[f.range[0]-g.start,f.range[1]-g.start];h.range=g.escapeResult?e(g.escapeResult,j):j,b[g.id].matches.push(h)}return b},a.prototype.getAdapterForMatch=function(a){return i.find(this.adapters,function(b){return a.range[0]>=b.start&&a.range[1]<=b.end})},a.prototype.replaceRanges=function(a,b){var c=this.remapMatches(b);for(var d in c)c[d].adapter.replaceRanges(a,c[d].matches)},a}();b.MultiEditorAdapter=j}(c=b.adapter||(b.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(a){function b(b){a.call(this,b),this.editorId=b.editorId}return __extends(b,a),b.prototype.getEditor=function(){return tinymce.get(this.editorId)},b.prototype.getContent=function(){return this.getEditor().getContent()},b.prototype.getEditorDocument=function(){return this.getEditor().getDoc()},b.prototype.scrollToCurrentSelection=function(){var a=this.getEditorDocument().getSelection();if(a)try{var b=a.getRangeAt(0),c=b.startContainer,d=b.startOffset,e=b.endContainer,f=b.endOffset;a.collapseToStart(),this.getEditor().insertContent("");var g=this.getEditorDocument().createRange();g.setStart(c,d),g.setEnd(e,f),a.removeAllRanges(),a.addRange(g)}catch(h){console.log("Scrolling Error: ",h)}},b}(a.AbstractRichtextEditorAdapter);a.TinyMCEAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.getEditor=function(){return tinymce.get(this.editorId)},b.prototype.getContent=function(){return this.getEditor().getContent()},b.prototype.getEditorDocument=function(){return this.getEditor().getDoc()},b.prototype.scrollToCurrentSelection=function(){var b=!1,c=this.getEditor().getBody(),d=c.getAttribute("style");d&&-1!==d.indexOf("overflow-y: hidden")&&(b=!0);var e=this.getEditor().getContainer().clientWidth,f=c.scrollWidth,g=e>f;g&&!b?a.prototype.scrollToCurrentSelection.call(this):this.scrollToCurrentSelectionWithGlobalScrollbar()},b.prototype.scrollToCurrentSelectionWithGlobalScrollbar=function(){var a=this.getEditorDocument().getSelection();if(a)try{this.scrollIntoViewWithGlobalScrollbar(a)}catch(b){console.log("Scrolling Error: ",b)}},b.prototype.scrollIntoViewWithGlobalScrollbar=function(a){var b=a.getRangeAt(0),c=b.cloneRange();c.collapse(!1);var d=this.getEditorDocument().createElement("span");c.insertNode(d);var e=d.getClientRects()[0].top;window.scrollTo(0,e),d.parentNode.removeChild(d)},b}(a.TinyMCEAdapter);a.TinyMCEWordpressAdapter=b}(b=a.adapter||(a.adapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){var c;!function(b){"use strict";function c(a){return a.offsetHeight>0&&a.offsetWidth>0}function d(a){void 0===a&&(a=document);var b=_.filter(a.querySelectorAll(i),c);return _.flatMap(b,function(a){if(!f(a))return[a];try{return a.contentDocument?d(a.contentDocument):[]}catch(b){return[]}})}function e(a){return void 0===a&&(a={}),d().map(function(b){var c=_.assign({},a,{element:b});return"INPUT"===b.nodeName||"TEXTAREA"===b.nodeName?new g(c):new h(c)})}var f=a.plugins.utils.isIFrame,g=a.plugins.adapter.InputAdapter,h=a.plugins.adapter.ContentEditableAdapter,i=["input:not([type])",'input[type=""]',"input[type=text]",'[contenteditable="true"]','[contenteditable="plaintext-only"]',"textarea","iframe"].join(", ");b.bindAdaptersForCurrentPage=e}(c=b.autobind||(b.autobind={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";function b(){var b=Math.max(300,Math.min(900,window.innerHeight-g.top-40)),c=document.createElement("style"),d=document.querySelector("head");c.innerHTML="\n      #"+a.SIDEBAR_ID+" {\n        top: "+g.top+"px;\n        left: "+g.left+"px;\n        position: fixed;\n        width: 300px;\n        padding-top: 20px;\n        cursor: move;\n        background: #3e96db;\n        height: "+b+"px;\n        box-shadow: 5px 5px 30px rgba(0, 0, 0, 0.3);\n        border-radius: 3px;\n        user-select: none;\n        z-index: 10000;\n          -moz-user-select: none;\n          -webkit-user-select: none;\n          -ms-user-select: none;\n      }\n  \n      #"+a.SIDEBAR_ID+" #"+a.SIDEBAR_CONTAINER_ID+",\n      #"+a.SIDEBAR_ID+" #acrolinxDragOverlay,\n      #"+a.SIDEBAR_ID+" #"+a.SIDEBAR_CONTAINER_ID+" iframe {\n        position: relative;\n        background: white;\n        height: 100%;\n        border: none;\n      }\n      \n      #"+a.SIDEBAR_ID+" #"+a.SIDEBAR_DRAG_OVERLAY_ID+" {\n        position: absolute;\n        top: 20px;\n        left: 0;\n        height: 300px;\n        width: 300px;\n        background: transparent;\n        z-index: 10001;\n      }\n       \n      #"+a.SIDEBAR_GLASS_PANE_ID+" {\n        position: fixed;\n        width: 100%;\n        height: 100%;\n        margin: 0;\n        padding: 0;\n        top: 0;\n        left: 0;\n        background: white;\n        opacity: 0.6;\n        z-index: 9999;\n      }\n    ",d.appendChild(c)}function c(a){var b=document.createElement("div");return b.id=a,b}function d(a){a.style.display="none"}function e(a){a.style.display="block"}function f(){function f(a,b){i.style.left=a+"px",i.style.top=b+"px"}function h(){console.log("End drag!!!"),d(j),d(k),m=!1}var i=c(a.SIDEBAR_ID),j=c(a.SIDEBAR_DRAG_OVERLAY_ID),k=c(a.SIDEBAR_GLASS_PANE_ID),l=document.querySelector("body"),m=!1,n=0,o=0;document.addEventListener("mousemove",function(a){m&&f(Math.max(a.clientX-n,0),Math.max(a.clientY-o,0))}),i.addEventListener("mousedown",function(a){var b=parseInt(i.style.left.replace("px",""))||g.left,c=parseInt(i.style.top.replace("px",""))||g.top;n=a.clientX-b,o=a.clientY-c,m=!0,e(j),e(k)}),document.addEventListener("mouseup",h),i.appendChild(c(a.SIDEBAR_CONTAINER_ID)),d(j),i.appendChild(j),b(),l.appendChild(i),d(k),l.appendChild(k)}a.SIDEBAR_ID="acrolinxFloatingSidebar",a.SIDEBAR_CONTAINER_ID="acrolinxSidebarContainer",a.SIDEBAR_DRAG_OVERLAY_ID="acrolinxDragOverlay",a.SIDEBAR_GLASS_PANE_ID="acrolinxFloatingSidebarGlassPane";var g={top:20,left:20};a.initFloatingSidebar=f}(b=a.floatingSidebar||(a.floatingSidebar={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";function b(a){return JSON.parse(JSON.stringify(a))}function c(a,c){for(var d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];a.postMessage({command:c,args:b(d)},"*")}function d(a,b){var d=function(d){var e=b[d];b[d]=function(){for(var f=[],g=0;g<arguments.length;g++)f[g-0]=arguments[g];return c.apply(void 0,[a,d].concat(f)),e.apply(b,f)}};for(var e in b)d(e)}function e(a,b){function c(a){var b=a.data,c=b.command,d=b.args;e[c]&&("requestInit"===c?e.requestInit(f):e[c].apply(e,d))}var e=a,f={init:function(a){},checkGlobal:function(a,b){return{checkId:"dummyCheckId"}},onGlobalCheckRejected:function(){},invalidateRanges:function(a){},onVisibleRangesChanged:function(a){}};d(b.contentWindow,f),addEventListener("message",c,!1)}function f(){function a(a){var c=a.data,d=c.command,e=c.args;b.acrolinxSidebar[d]&&b.acrolinxSidebar[d].apply(b.acrolinxSidebar,e)}var b=window;addEventListener("message",a,!1);var c={requestInit:function(){},onInitFinished:function(a){},configure:function(a){},requestGlobalCheck:function(){},onCheckResult:function(a){},selectRanges:function(a,b){},replaceRanges:function(a,b){},download:function(a){},openWindow:function(a){}};return d(window.parent,c),c}a.connectAcrolinxPluginToMessages=e,a.createPluginMessageAdapter=f}(b=a.messageAdapter||(a.messageAdapter={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){"use strict";function b(a){var b=document.createElement("link");return b.rel="stylesheet",b.href=a,b}function c(a){var b=document.createElement("script");return b.src=a,b.type="text/javascript",b.async=!1,b.defer=!1,b}function d(d){void 0===d&&(d=a.SIDEBAR_URL);var e=d,f=function(a){return a.replace(/^.*"(.*)".*$/g,e+"$1")};a.fetch(e+"index.html",function(a){var d=a.replace(/<!--[\s\S]*?-->/g,""),e=document.querySelector("head"),g=d.match(/href=".*?"/g).map(f);g.forEach(function(a){e.appendChild(b(a))});var h=d.match(/src=".*?"/g).map(f);h.forEach(function(a){e.appendChild(c(a))})})}function e(b,c,d){var e=b.sidebarUrl||a.SIDEBAR_URL,f=e+"index.html";b.useMessageAdapter||b.useSidebarFromSameOriginDirectly&&a.isFromSameOrigin(e)?(c.addEventListener("load",d),c.src=f):a.fetch(f,function(a){var b=c.contentWindow,f=a.replace(/src="/g,'src="'+e).replace(/href="/g,'href="'+e);b.document.open(),b.document.write(f),b.document.close(),d()})}a.SIDEBAR_URL="https://acrolinx-sidebar-classic.s3.amazonaws.com/v14/prod/",a.loadSidebarCode=d,a.loadSidebarIntoIFrame=e}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(b){"use strict";function c(a){return void 0!==a.then}function d(a,b){function d(){function b(){i.init(f.assign({},{showServerSelector:!0,clientComponents:k},a))}function d(){return a.getDocumentReference&&a.getDocumentReference()||window.location.href}function e(a,b,c){if(a.hasOwnProperty("error"))window.alert(a.error);else{var e=i.checkGlobal(a.content,{inputFormat:b||"HTML",requestDescription:{documentReference:c||d()}});l.registerCheckCall(e)}}var i,m={requestInit:function(a){i=a||j.acrolinxSidebar,console.log("requestInit"),b()},onInitFinished:function(a){console.log("onInitFinished: ",a),a.error&&window.alert(a.error.message)},configure:function(a){console.log("configure: ",a)},requestGlobalCheck:function(){var a=l.extractContentForCheck(),b=l.getFormat?l.getFormat():null,d=l.getDocumentReference?l.getDocumentReference():null;c(a)?a.then(function(a){e(a,b,a.documentReference||d)}):e(a,b,a.documentReference||d)},onCheckResult:function(a){return l.registerCheckResult(a)},selectRanges:function(a,b){console.log("selectRanges: ",a,b);try{l.selectRanges(a,b)}catch(c){console.log(c),i.invalidateRanges(b.map(function(b){return{checkId:a,range:b.range}}))}},replaceRanges:function(a,b){console.log("replaceRanges: ",a,b);try{l.replaceRanges(a,b)}catch(c){console.log(c),i.invalidateRanges(b.map(function(b){return{checkId:a,range:b.range}}))}},download:function(a){console.log("download: ",a.url,a),window.open(a.url)},openWindow:function(a){var b=a.url;window.open(b)}};a.onSidebarWindowLoaded&&a.onSidebarWindowLoaded(j),console.log("Install acrolinxPlugin in sidebar."),a.useMessageAdapter?h(m,g):j.acrolinxPlugin=m}var e=document.getElementById(a.sidebarContainerId);if(!e)throw new Error("Acrolinx can't find an element with the configured sidebarContainerId \""+a.sidebarContainerId+'".');var g=document.createElement("iframe");e.appendChild(g);var j=g.contentWindow,l=b;i(a,g,d)}function e(c){var d=f.assign({},c,{sidebarContainerId:b.floatingSidebar.SIDEBAR_CONTAINER_ID});g();var e=new a.plugins.AcrolinxPlugin(d);e.registerAdapter(new j(d)),e.init()}var f=acrolinxLibs._,g=a.plugins.floatingSidebar.initFloatingSidebar,h=a.plugins.messageAdapter.connectAcrolinxPluginToMessages,i=a.plugins.utils.loadSidebarIntoIFrame,j=a.plugins.adapter.AutoBindAdapter,k=[{id:"com.acrolinx.sidebarexample",name:"Acrolinx Sidebar Example Client",version:"1.2.3.999",category:"MAIN"}],l=function(){function a(a){this.config=a}return a.prototype.registerAdapter=function(a){this.adapter=a},a.prototype.init=function(){d(this.config,this.adapter)},a}();b.AcrolinxPlugin=l,b.autoBindFloatingSidebar=e}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));var acrolinx;!function(a){var b;!function(a){var b;!function(a){function b(a,b){return{text:a,domPositions:b}}function c(a){return{text:a.map(function(a){return a.text}).join(""),domPositions:g.flatten(a.map(function(a){return a.domPositions}))}}function d(a,b){return{node:a,offset:b}}function e(a){return c(g.map(a.childNodes,function(a){switch(a.nodeType){case Node.ELEMENT_NODE:return i[a.nodeName]?h:e(a);case Node.TEXT_NODE:default:return b(a.textContent,g.times(a.textContent.length,function(b){return d(a,b)}))}}))}function f(a,b){var c=b[Math.max(Math.min(a,b.length)-1,0)];return{node:c.node,offset:c.offset+1}}var g=acrolinxLibs._,h=Object.freeze({text:"",domPositions:[]});a.textMapping=b,a.concatTextMappings=c,a.domPosition=d;var i=a.toSet(["SCRIPT","STYLE"]);a.extractTextDomMapping=e,a.getEndDomPos=f}(b=a.utils||(a.utils={}))}(b=a.plugins||(a.plugins={}))}(acrolinx||(acrolinx={}));
//# sourceMappingURL=acrolinx-sidebar-integration.min.js.map